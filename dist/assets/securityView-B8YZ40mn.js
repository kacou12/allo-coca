import{a0 as ee,c as F,w as te,a1 as De,d as R,Z as we,r as S,k as J,O as Ne,K as H,m as r,x as d,f as o,p as i,q as e,B as O,G as q,y as U,a3 as Ae,l as c,F as Q,C as Oe,u as ae,t as pe,a4 as Ve,a5 as qe,N as M,E as G,X as Le,_ as fe,$ as Qe,J as Ie,a6 as Pe,a7 as ke,n as ce,a8 as Ge,H as Xe}from"./index-DkfXgpcC.js";import{u as Ee}from"./useQuery-Di2ibVa4.js";import{u as re}from"./useMutation-CqjTsKS8.js";import{H as Y}from"./Http-BUEd-bjA.js";import{c as le,u as Te}from"./useAuthQueries-CYnWXC5B.js";import{_ as ne}from"./customButton.vue_vue_type_script_setup_true_lang-BH0vS9yW.js";import{a as Je,b as Ye,c as Ze,d as et,e as tt,f as st,_ as ve}from"./commonModal.vue_vue_type_script_setup_true_lang-C5TGRvxu.js";import{_ as nt}from"./commonClipBoard.vue_vue_type_script_setup_true_lang-H92bW-pp.js";import{c as ye}from"./createLucideIcon-B01bX9rG.js";import{_ as X}from"./index-DibH2ssM.js";import{_ as me}from"./InputField.vue_vue_type_script_setup_true_lang-DjDHwPgk.js";import{_ as Me}from"./selectField.vue_vue_type_script_setup_true_lang-DQZkxwRl.js";import{E as j,c as je,K as $e,W as I}from"./constant.enum-DAK-M0ps.js";import{u as ie,o as ze,d as Ue,s as se,f as ot}from"./axios-CQ5ThyI4.js";import{u as We,t as Be,a as at}from"./vee-validate-zod-CnFvfQAl.js";import{_ as z}from"./Skeleton.vue_vue_type_script_setup_true_lang-RJjQvA3k.js";import{F as He}from"./fadeInAnimation-BTiIx4IU.js";import{K as Ce}from"./datatable.interface-CAlaPxYo.js";import{C as Se,S as rt}from"./search-rrj2n-jv.js";import{X as lt}from"./x-CwcFVxe-.js";import{C as Fe,a as Ke}from"./chevron-down-Ctm0sjbZ.js";import"./auth-service-B91mFMcP.js";import"./useAuthStore-C2GFTR6E.js";import"./index-ddJ0Efsx.js";import"./Input.vue_vue_type_script_setup_true_lang-CLXxopyR.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-BMjVBBvu.js";/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=ye("CaptionsIcon",[["rect",{width:"18",height:"14",x:"3",y:"5",rx:"2",ry:"2",key:"12ruh7"}],["path",{d:"M7 15h4M15 15h2M7 11h2M13 11h4",key:"1ueiar"}]]);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=ye("TriangleAlertIcon",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=ye("UserRoundPlusIcon",[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M22 19h-6",key:"vcuq98"}]]),Z={all:["keys"],keysFilters:t=>["keykeysFilters",t.page,t.q],key:t=>[...Z.all,t]},he={default:"/merchant/api/v1/key"};async function ct(t){return await Y.get(he.default,t)}async function mt(t){return await Y.post(he.default,t)}async function pt({id:t}){return await Y.delete(`${he.default}/${t}`)}async function ft(t){try{const s=await ct(t);return s==null?void 0:s.data}catch(s){throw Error(s.response.data.message)}}async function vt(t){try{const s=await mt(t);return s==null?void 0:s.data}catch(s){throw console.log(s),Error(s.response.data.error)}}async function yt(t){try{const s=await pt({id:t});return s==null?void 0:s.data}catch(s){throw Error(s.response.data.error)}}const ht={q:void 0,page:1},N=De({...ht});function xt(t=!0){const s=ee(),n=()=>{s.invalidateQueries({queryKey:Z.keysFilters({...N})})},v=Ee({queryKey:F(()=>Z.keysFilters({...N})),queryFn:({signal:u})=>ft({...N}),enabled:t});return te(()=>({q:N.q}),()=>{N.page=1,v.refetch()},{deep:!0}),{...v,filters:N,invalidateQuery:n}}function gt(){const t=ee();return re({mutationFn:s=>vt(s),onSuccess:()=>{t.invalidateQueries({queryKey:Z.keysFilters({...N})})},onError:()=>{console.log("===================================="),console.log("on error "),console.log("===================================="),t.invalidateQueries({queryKey:le.profil})}})}function bt(t){const s=ee();return re({mutationFn:n=>yt(n),onSuccess:()=>{s.invalidateQueries({queryKey:Z.keysFilters({...N})})},onError:()=>{s.invalidateQueries({queryKey:le.profil})}})}const _t={class:"space-y-4 p-4"},wt={class:"gap-2 space-y-1 rounded-md bg-[#ffedd5] p-4 text-orange-800 border border-left-4 border-left-[#FA703F]",style:{"background-color":"#FEF3EB",color:"#B45309"}},kt={class:"flex items-center gap-2 text-[#771505]"},$t={class:"flex justify-between items-center rounded-md border border-gray-300 bg-gray-50 p-3"},Ct={class:"text-xs flex flex-wrap"},St={class:"p-4 w-full flex gap-x-2 border-t-[1px]"},Ft=R({__name:"confirmKeyModal",props:we({backgroudColor:{default:"bg-[#F5F5F5]",type:String},showDivider:{default:!0,type:Boolean},secretKey:{type:String,default:""}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:we(["close"],["update:modelValue"]),setup(t,{emit:s}){const n=S(!1),v=J(),u=Ne(t,"modelValue"),y=s,L=()=>{u.value=!1,n.value=!1,y("close")},_=()=>{Ae(t.secretKey),n.value=!0,v.info("copie effectué",{timeout:3e3})};return(k,m)=>(r(),H(i(st),{open:u.value,"onUpdate:open":m[1]||(m[1]=V=>u.value=V)},{default:d(()=>[o(i(Je),{"as-child":""}),o(i(Ye),{onInteractOutside:V=>{V.preventDefault()},class:"max-w-[90%] rounded-lg sm:max-w-[750px] font-worksans"},{default:d(()=>[o(i(Ze),{class:O([[t.showDivider?"border-b-[1px]":""],"flex flex-row justify-between border-neutral-200"])},{default:d(()=>[o(i(et),null,{default:d(()=>m[2]||(m[2]=[e("h2",{class:"text-lg font-bold text-red-600"},"Important : Votre clé secrète",-1)])),_:1,__:[2]})]),_:1},8,["class"]),e("section",{class:O(`text-sm px-4 py-4 ${t.backgroudColor}`)},[e("div",_t,[e("div",wt,[e("div",kt,[o(i(ut),{class:"w-5 h-5"}),m[3]||(m[3]=e("p",{class:"text-[#771505] font-bold"},"Attention",-1))]),m[4]||(m[4]=e("div",null,[e("p",null,"Veuillez copier cette clé immédiatement. Elle ne sera **pas** affichée à nouveau après la fermeture de cette fenêtre.")],-1))]),e("div",$t,[e("p",Ct,q(t.secretKey),1),o(nt,{onCopy:m[0]||(m[0]=V=>n.value=!0),"data-to-copy":t.secretKey},null,8,["data-to-copy"])])])],2),o(i(tt),null,{default:d(()=>[e("div",St,[o(ne,{"is-disabled":!n.value,class:"w-full py-[22px] text-sm rounded-lg font-medium",variant:"destructive",onClick:L},{default:d(()=>m[5]||(m[5]=[U(" Fermer ")])),_:1,__:[5]},8,["is-disabled"]),o(ne,{class:"w-full py-[22px] text-sm rounded-lg font-medium",variant:"default",onClick:_},{default:d(()=>m[6]||(m[6]=[U(" Copier ")])),_:1,__:[6]})])]),_:1})]),_:1},8,["onInteractOutside"])]),_:1},8,["open"]))}}),Kt={class:"flex items-center gap-2"},At={class:"space-y-4"},Vt={class:""},qt={class:"w-full max-w-[512px]"},Lt={class:""},Et={class:""},Tt={class:"flex gap-2 px-6 py-5 w-full"},Mt=R({__name:"apiTokensModal",props:{canAddLiveKey:{type:Boolean,required:!0},canAddSandboxKey:{type:Boolean,required:!0}},setup(t){const s=J(),n=F(()=>{let $=[];return t.canAddLiveKey&&$.push({name:"Live",value:j.Live}),t.canAddSandboxKey&&$.push({name:"Sandbox",value:j.Sandbox}),$}),{startLoading:v,stopLoading:u}=ie(),y=S(!1),L=S(!1),_=S(""),k=ze({name:se().min(1,{message:"Le nom ne peut pas être vide"}).trim(),environment:Ue(j,{required_error:"L’environnement est requis"})}),{handleSubmit:m,resetForm:V}=We({validationSchema:Be(k)}),E=()=>{console.log("closing"),_.value=""},{mutateAsync:W}=gt(),D={name:void 0,environment:void 0},g=S({...D});te(y,$=>{$&&(g.value={...D})});const a=async()=>{v();try{const $=await W(g.value);_.value=$.key,y.value=!1,L.value=!0,V(),s.success("Le token a bien été crée")}catch{}finally{u()}},b=m(async({})=>{await a()});return($,p)=>(r(),c(Q,null,[o(ve,{"handle-submit":i(b),"backgroud-color":"bg-white",open:y.value,"onUpdate:open":p[3]||(p[3]=f=>y.value=f),showDivider:!1},{trigger:d(()=>[o(ne,{type:"outline"},{default:d(()=>[e("div",Kt,[o(i(dt),{class:"w-5 h-5 mr-2"}),p[5]||(p[5]=e("span",null,"GENERATE TOKEN",-1))])]),_:1})]),title:d(()=>p[6]||(p[6]=[e("span",null,"API token",-1)])),content:d(()=>[e("div",At,[e("section",Vt,[p[7]||(p[7]=e("div",null,[e("p",{class:"flex-1 text-neutral-20"},"Nom")],-1)),e("div",qt,[o(me,{name:"name",modelValue:g.value.name,"onUpdate:modelValue":p[0]||(p[0]=f=>g.value.name=f),type:"text",id:"name",placeholder:"Api token name",class:"py-2 pr-12",required:""},null,8,["modelValue"])])]),e("section",Lt,[p[8]||(p[8]=e("div",null,[e("p",{class:"flex-1 text-neutral-20"},"Environnement")],-1)),e("div",Et,[o(Me,{name:"environment",modelValue:g.value.environment,"onUpdate:modelValue":p[1]||(p[1]=f=>g.value.environment=f),"border-color":"border-neutral-60","default-width":"w-full",title:"Environnement",elements:n.value},null,8,["modelValue","elements"])])])])]),footer:d(()=>[e("div",Tt,[o(i(X),{class:"flex-1 py-[22px] text-sm rounded-lg font-medium",variant:"outline",onClick:p[2]||(p[2]=f=>y.value=!1)},{default:d(()=>p[9]||(p[9]=[U(" Annuler ")])),_:1,__:[9]}),o(i(X),{type:"submit",class:"flex-1 py-[22px] text-sm rounded-lg bg-primary font-normal",variant:"default"},{default:d(()=>p[10]||(p[10]=[U(" Generate ")])),_:1,__:[10]})])]),_:1},8,["handle-submit","open"]),o(Ft,{onClose:E,"secret-key":_.value,modelValue:L.value,"onUpdate:modelValue":p[4]||(p[4]=f=>L.value=f),"backgroud-color":"bg-white"},null,8,["secret-key","modelValue"])],64))}}),jt={class:"text-center"},zt={class:"flex gap-2 px-6 py-5 w-full"},Re=R({__name:"confirmModal",props:{confirmHandler:{type:Function,required:!0},confirmText:{type:String,required:!1,default:"Voulez vous vraiment effectuer cette action ?"}},setup(t){const s=S(!1),n=async()=>{await t.confirmHandler(),s.value=!1};return(v,u)=>(r(),H(ve,{"backgroud-color":"bg-white",open:s.value,"onUpdate:open":u[1]||(u[1]=y=>s.value=y),showDivider:!1},{trigger:d(()=>[Oe(v.$slots,"default")]),title:d(()=>u[2]||(u[2]=[U("Confirmation")])),content:d(()=>[e("div",jt,q(t.confirmText),1)]),footer:d(()=>[e("div",zt,[o(i(X),{class:"flex-1 py-[22px] text-sm rounded-lg font-medium",variant:"outline",onClick:u[0]||(u[0]=y=>s.value=!1)},{default:d(()=>u[3]||(u[3]=[U(" Annuler ")])),_:1,__:[3]}),o(i(X),{onClick:n,class:"flex-1 py-[22px] text-sm rounded-lg bg-primary font-normal",variant:"default"},{default:d(()=>u[4]||(u[4]=[U(" Confirmer ")])),_:1,__:[4]})])]),_:3},8,["open"]))}}),Ut={class:""},Wt={key:1,class:"h-full w-full flex justify-center px-1 py-1 rounded-sm"},Bt=R({__name:"webhookAndKeyClipBoard",props:{dataToCopy:{type:String||Number,required:!0},successMessage:{type:String,required:!1,default:"copie effectué"}},setup(t){const s=J(),n=S(!1),v=()=>{Ae(t.dataToCopy),s.info(t.successMessage,{timeout:3e3}),n.value=!0};return te(n,(u,y)=>{u&&setTimeout(()=>{n.value=!1},3e3)}),(u,y)=>(r(),c("div",Ut,[o(He,{class:"h-full w-full flex items-end"},{default:d(()=>[n.value?(r(),c("div",Wt,y[1]||(y[1]=[e("svg",{width:"24",height:"24",viewBox:"0 0 21 21",xmlns:"http://www.w3.org/2000/svg",fill:"#000000"},[e("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"}),e("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"}),e("g",{id:"SVGRepo_iconCarrier"},[e("g",{fill:"none","fill-rule":"evenodd",stroke:"#000000","stroke-linecap":"round","stroke-linejoin":"round",transform:"translate(4 3)"},[e("path",{d:"m3.5 1.5c-.42139382 0-1.08806048 0-2 0-.55228475 0-1 .44771525-1 1v11c0 .5522848.44771525 1 1 1h10c.5522847 0 1-.4477152 1-1v-11c0-.55228475-.4477153-1-1-1-.8888889 0-1.55555556 0-2 0"}),e("path",{d:"m4.5.5h4c.55228475 0 1 .44771525 1 1s-.44771525 1-1 1h-4c-.55228475 0-1-.44771525-1-1s.44771525-1 1-1z"}),e("path",{d:"m3.5 8.5 2 2 5-5"})])])],-1)]))):(r(),c("div",{key:0,class:"cursor-pointer bg-gray-100 hover:bg-gray-200 h-full w-full flex justify-center px-1 items-end rounded-sm",onClick:v},y[0]||(y[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",viewBox:"0 0 25 25",fill:"none",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2"})],-1)])))]),_:1})]))}}),Ht={class:"bg-white rounded-lg shadow-md p-6 my-4"},Rt={class:"flex justify-between flex-col md:flex-row mb-5"},Dt={class:""},Nt={class:"w-full overflow-x-auto"},Ot={class:"min-w-[600px]"},Qt={class:"w-full mb-6 rounded-t-xl"},It={key:0},Pt={class:"py-3"},Gt={class:"py-3"},Xt={class:"py-3"},Jt={class:"py-3"},Yt={class:"py-3"},Zt={class:"flex justify-end gap-2"},es={key:1},ts={key:0},ss={class:"py-3 font-mono text-sm"},ns={class:"py-3"},os={class:"bg-blue-100 text-blue-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded"},as={class:"py-3 px-4 font-mono"},rs={class:"py-3 text-right"},ls={class:"flex justify-end gap-2"},is=R({__name:"apiTokens",setup(t){const s=ae(),n=J(),{startLoading:v,stopLoading:u,stopLoadingSkeleton:y}=ie(),{mutateAsync:L}=bt(s.params.id),{isFetched:_,data:k,isFetching:m}=xt(),{data:V,refetch:E,isLoading:W,isFetched:D,isFetching:g}=Te({enabled:!0}),a=F(()=>{var l,h;return((h=(l=V.value)==null?void 0:l.merchant)==null?void 0:h.status)===je.active}),b=F(()=>_.value?k.value.items.filter(l=>l.environment===j.Live).length===0||k.value.items.filter(l=>l.environment===j.Live).every(l=>l.status===$e.revoked):!1),$=F(()=>_.value?k.value.items.filter(l=>l.environment===j.Sandbox).length===0||k.value.items.filter(l=>l.environment===j.Sandbox).every(l=>l.status===$e.revoked):!1);function p(l){if(!l)return null;const h=l.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");for(const[K,ue]of Object.entries(Ce))if(ue.enumName.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")===h)return K;return null}const f=l=>{const h=p(l);return Ce[h]},C=async l=>{try{v(),await L(l),n.success("Le token a bien été supprimé")}catch{}};return(l,h)=>(r(),c("div",Ht,[e("section",Rt,[h[0]||(h[0]=e("div",null,[e("h2",{class:"text-xl font-semibold mb-2"},"Manage API Tokens"),e("p",{class:"text-gray-600 mb-6 text-sm"}," API tokens allow third-party services. You may revoke any of your existing tokens if they are no longer in use. ")],-1)),pe(e("div",Dt,[o(Mt,{"can-add-live-key":b.value,"can-add-sandbox-key":$.value},null,8,["can-add-live-key","can-add-sandbox-key"])],512),[[Ve,a.value&&(b.value||$.value)]])]),e("section",Nt,[e("div",Ot,[e("table",Qt,[h[4]||(h[4]=e("thead",null,[e("tr",{class:"border-b"},[e("th",{class:"py-2 text-left text-gray-500 font-medium text-sm"},"Name"),e("th",{class:"py-2 text-left text-gray-500 font-medium text-sm"},"Environnement"),e("th",{class:"py-2 text-left text-gray-500 font-medium text-sm"},"Token"),e("th",{class:"py-2 px-4 text-left text-gray-500 font-medium text-sm"},"Statut"),e("th",{class:"py-2 text-right text-gray-500 font-medium text-sm"},"Actions")])],-1)),o(qe,{name:"fade-slide"},{default:d(()=>[i(m)?(r(),c("tbody",It,[(r(),c(Q,null,G(3,K=>e("tr",{key:K,class:"border-b"},[e("td",Pt,[o(z,{class:"h-4 w-24"})]),e("td",Gt,[o(z,{class:"h-4 w-32"})]),e("td",Xt,[o(z,{class:"h-4 w-full"})]),e("td",Jt,[o(z,{class:"h-4 w-full"})]),e("td",Yt,[e("div",Zt,[o(z,{class:"h-8 w-8 rounded"})])])])),64))])):i(_)?(r(),c("tbody",es,[i(k).items.length===0?(r(),c("tr",ts,h[1]||(h[1]=[e("td",{colspan:"4",class:"py-4 text-center text-gray-500"},"No tokens found",-1)]))):M("",!0),(r(!0),c(Q,null,G(i(k).items,K=>(r(),c("tr",{key:K.id,class:"border-b"},[e("td",ss,[e("span",null,q(K.name),1)]),e("td",ns,[e("span",os,q(K.environment),1)]),h[3]||(h[3]=e("td",{class:"py-3 font-mono text-sm"},[e("span",null,"••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••")],-1)),e("td",as,[e("div",null,[e("span",{class:O("text-xs text-center font-medium px-2 py-[1px] rounded-2xl"),style:Le({backgroundColor:f(K.status).color,color:f(K.status).textColor})},q(f(K.status).name),5)])]),e("td",rs,[e("div",ls,[a.value?(r(),H(Re,{key:0,confirmHandler:()=>C(K.id),"confirm-text":`Voulez vous vraiment supprimer le token ${K.name} ?`},{default:d(()=>h[2]||(h[2]=[e("button",{class:"p-1.5 bg-red-100 hover:bg-red-200 rounded transition"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})])],-1)])),_:2,__:[2]},1032,["confirmHandler","confirm-text"])):M("",!0)])])]))),128))])):M("",!0)]),_:1})])])])]))}}),us=fe(is,[["__scopeId","data-v-cc0f08a8"]]),xe={all:["webhooks"],webhookFilters:t=>["webhooks",t.page,t.q,t.environment,t.merchant_id,t.size],webhook:t=>["webhooks",t]},ge={default:"/merchant/api/v1/webhook",getOne:t=>`/merchant/api/v1/webhook/${t}`};async function ds({payload:t}){return await Y.get(ge.default,t)}async function cs(t){return await Y.post(ge.default,t)}async function ms(t){return await Y.delete(ge.getOne(t))}async function ps(t){try{let s={...t};const n=await ds({payload:t});return n==null?void 0:n.data}catch(s){throw Error(s.response.data.message)}}async function fs(t){try{const s=await cs(t);return s==null?void 0:s.data}catch(s){throw Error(s.response.data.error)}}async function vs(t){try{const s=await ms(t);return s==null?void 0:s.data}catch(s){throw Error(s.response.data.error)}}const A={q:void 0,page:1,environment:void 0,merchant_id:void 0,size:10},ys=Qe("webhookFilters",()=>{const t=S(A.q),s=S(A.page),n=S(A.environment),v=S(A.merchant_id),u=S(A.size),y=ae();return te(()=>y.name,(L,_)=>{(t.value!=A.q||s.value!=A.page||n.value!=A.environment||v.value!=A.merchant_id||u.value!=A.size)&&(t.value=A.q,s.value=A.page,n.value=A.environment,v.value=A.merchant_id,u.value=A.size)}),{q:t,page:s,environment:n,merchant_id:v,size:u}}),B=Ie(ys()),oe=()=>({page:B.page.value,q:B.q.value,environment:B.environment.value,merchant_id:B.merchant_id.value,size:B.size.value});function hs(){const t=Ee({queryKey:F(()=>xe.webhookFilters(oe())),queryFn:({signal:s})=>ps(oe())});return te(()=>({q:B.q.value,environment:B.environment.value,merchant_id:B.merchant_id.value,size:B.size.value}),()=>{B.page.value=1,t.refetch()},{deep:!0}),{...t}}function xs(t){const s=ee();return re({mutationFn:n=>fs(n),onSuccess:()=>{s.invalidateQueries({queryKey:xe.webhookFilters(oe())})},onError:()=>{s.invalidateQueries({queryKey:le.profil})}})}function gs(t){const s=ee();return re({mutationFn:n=>vs(n),onSuccess:()=>{s.invalidateQueries({queryKey:xe.webhookFilters(oe())})},onError:()=>{s.invalidateQueries({queryKey:le.profil})}})}const bs={class:"relative"},_s={key:0,class:"flex justify-between items-center w-full"},ws={class:"flex flex-wrap items-center"},ks={class:"flex items-center justify-between"},$s={key:1,class:"flex items-center justify-between w-full mx-auto"},Cs={class:"text-sm text-muted-foreground mx-3"},Ss={key:0,class:"absolute z-50 w-full mt-1 bg-white rounded-md shadow-lg"},Fs={class:"p-2"},Ks={class:"flex items-center px-3 py-2 border rounded-md"},As={class:"mt-2 max-h-[200px] overflow-y-scroll"},Vs=["onClick"],qs={class:"flex items-center justify-between mt-2 pt-2 border-t"},Ls={key:1,class:"w-px h-6 bg-gray-200"},Es={class:"min-h-[20px] mt-2"},Ts={key:0,class:"app-form-item-error text-error-500 text-sm font-worksans font-normal"},Ms={key:1},js=R({__name:"multiSelectField",props:{options:{},modelValue:{},placeholder:{default:"Select options"},animation:{default:0},maxCount:{default:3},variant:{default:"default"},disabled:{type:Boolean,default:!1},name:{}},emits:["update:modelValue"],setup(t,{emit:s}){const n=t,{value:v,errorMessage:u,meta:y,validate:L,setValue:_,setErrors:k,handleBlur:m,handleChange:V}=at(()=>n.name,{value:Pe(n,"modelValue")}),E=s,W=S(!1),D=S(!1),g=S(""),a=F(()=>n.modelValue??[]),b=F(()=>n.options.filter(x=>x.label.toLowerCase().includes(g.value.toLowerCase()))),$=F(()=>a.value.slice(0,n.maxCount)),p=F(()=>a.value.length>n.maxCount),f=F(()=>a.value.length-n.maxCount),C=F(()=>{const x="m-1 transition ease-in-out delay-150 hover:-translate-y-1 hover:scale-110 duration-300";switch(n.variant){case"secondary":return`${x} border-foreground/10 bg-secondary text-secondary-foreground hover:bg-secondary/80`;case"destructive":return`${x} border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80`;case"inverted":return`${x} inverted`;default:return`${x} border-foreground/10 text-foreground bg-card hover:bg-card/80`}}),l=x=>{if(n.disabled)return;const T=a.value.includes(x)?a.value.filter(w=>w!==x):[...a.value,x];E("update:modelValue",T),_(T)},h=()=>{n.disabled||(E("update:modelValue",[]),_([]))},K=()=>{n.disabled||(a.value.length===n.options.length?h():(E("update:modelValue",n.options.map(x=>x.value)),_(n.options.map(x=>x.value))))},ue=()=>{n.disabled||E("update:modelValue",a.value.slice(0,n.maxCount))};return(x,T)=>(r(),c(Q,null,[e("div",bs,[e("button",{onClick:T[0]||(T[0]=w=>!x.disabled&&(W.value=!W.value)),class:O(["flex w-full p-1  rounded-md border min-h-10 h-auto items-center justify-between bg-inherit hover:bg-inherit",x.disabled?"opacity-50 cursor-not-allowed":"",i(u)?"border-error-light-2  focus:ring-transparent":"border-neutral-60"])},[a.value.length>0?(r(),c("div",_s,[e("div",ws,[(r(!0),c(Q,null,G($.value,w=>{var de,be,_e;return r(),c("div",{key:w,class:O([C.value,"inline-flex items-center px-2.5 py-0.5 rounded-full border-2 border-primary text-sm font-medium"]),style:Le(D.value?{animationDuration:`${n.animation}s`}:{})},[(de=n.options.find(P=>P.value===w))!=null&&de.icon?(r(),H(ke((be=n.options.find(P=>P.value===w))==null?void 0:be.icon),{key:0,class:"h-4 w-4 mr-2"})):M("",!0),U(" "+q((_e=n.options.find(P=>P.value===w))==null?void 0:_e.label)+" ",1),o(i(Se),{class:"ml-2 h-4 w-4 cursor-pointer",onClick:ce(P=>l(w),["stop"])},null,8,["onClick"])],6)}),128)),p.value?(r(),c("div",{key:0,class:O([C.value,"bg-transparent text-foreground border-foreground/10 hover:bg-transparent inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium"])},[U(" + "+q(f.value)+" more ",1),o(i(Se),{class:"ml-2 h-4 w-4 cursor-pointer",onClick:ce(ue,["stop"])})],2)):M("",!0)]),e("div",ks,[o(i(lt),{class:"h-4 mx-2 cursor-pointer text-muted-foreground",onClick:ce(h,["stop"])}),T[3]||(T[3]=e("div",{class:"w-px h-6 bg-gray-200 mx-2"},null,-1)),o(i(Fe),{class:"h-4 mx-2 cursor-pointer text-muted-foreground"})])])):(r(),c("div",$s,[e("span",Cs,q(x.placeholder),1),o(i(Fe),{class:"h-4 cursor-pointer text-muted-foreground mx-2"})]))],2),W.value?(r(),c("div",Ss,[e("div",Fs,[e("div",Ks,[o(i(rt),{class:"w-4 h-4 text-gray-400"}),pe(e("input",{"onUpdate:modelValue":T[1]||(T[1]=w=>g.value=w),type:"text",placeholder:"Search...",class:"w-full px-2 py-1 text-sm border-none focus:outline-none"},null,512),[[Ge,g.value]])]),e("div",As,[e("button",{onClick:K,class:"flex items-center w-full px-3 py-2 text-sm hover:bg-gray-100 rounded-md"},[e("div",{class:O(["mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",a.value.length===x.options.length?"bg-primary text-primary-foreground":"opacity-50"])},[a.value.length===x.options.length?(r(),H(i(Ke),{key:0,class:"h-4 w-4"})):M("",!0)],2),T[4]||(T[4]=e("span",null,"(Select All)",-1))]),(r(!0),c(Q,null,G(b.value,w=>(r(),c("button",{key:w.value,onClick:de=>l(w.value),class:"flex items-center w-full px-3 py-2 text-sm hover:bg-gray-100 rounded-md"},[e("div",{class:O(["mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",a.value.includes(w.value)?"bg-primary text-primary-foreground":"opacity-50"])},[a.value.includes(w.value)?(r(),H(i(Ke),{key:0,class:"h-4 w-4"})):M("",!0)],2),w.icon?(r(),H(ke(w.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):M("",!0),e("span",null,q(w.label),1)],8,Vs))),128))]),e("div",qs,[a.value.length>0?(r(),c("button",{key:0,onClick:h,class:"flex-1 px-3 py-2 text-sm text-center hover:bg-gray-100 rounded-md"}," Clear ")):M("",!0),a.value.length>0?(r(),c("div",Ls)):M("",!0),e("button",{onClick:T[2]||(T[2]=w=>W.value=!1),class:"flex-1 px-3 py-2 text-sm text-center hover:bg-gray-100 rounded-md"}," Close ")])])])):M("",!0)]),e("div",Es,[o(He,{mode:"out-in"},{default:d(()=>[i(u)?(r(),c("small",Ts,q(i(u)),1)):(r(),c("div",Ms))]),_:1})])],64))}}),zs=fe(js,[["__scopeId","data-v-70074d2c"]]),Us={class:"flex items-center gap-2"},Ws={class:"space-y-4"},Bs={class:""},Hs={class:"w-full max-w-[512px]"},Rs={class:""},Ds={class:"w-full max-w-[512px]"},Ns={class:""},Os={class:""},Qs={class:""},Is={class:""},Ps={class:"flex gap-2 px-6 py-5 w-full"},Gs=R({__name:"webHooksModal",props:{canAddLiveKey:{type:Boolean,required:!0},canAddSandboxKey:{type:Boolean,required:!0}},setup(t){const s=ze({name:se().min(1,"Le nom est requis."),url:se().url("L'URL doit être une URL valide.").min(1,"L'URL est requise.").startsWith("https://","L'URL doit commencer par 'https://'.").refine(g=>g.includes("."),"L'URL doit contenir un point."),events:ot(se()).min(1,"Veuillez sélectionner au moins un événement."),environment:Ue(j,{errorMap:()=>({message:"Veuillez sélectionner un environnement valide."})})}),n=ae(),v=J(),{startLoading:u}=ie(),{mutateAsync:y}=xs(n.params.id),{handleSubmit:L,resetForm:_}=We({validationSchema:Be(s)}),k=F(()=>{let g=[];return t.canAddLiveKey&&g.push({name:"Live",value:j.Live}),t.canAddSandboxKey&&g.push({name:"Sandbox",value:j.Sandbox}),g}),m=S({events:[],environment:"",url:void 0,name:void 0}),V=[{label:"Transaction Created",value:I.TransactionCreated},{label:"Transaction Processing",value:I.TransactionProcessing},{label:"Transaction Pending",value:I.TransactionPending},{label:"Transaction Updated",value:I.TransactionUpdated},{label:"Transaction Failed",value:I.TransactionFailed},{label:"Transaction Refunded",value:I.TransactionRefunded},{label:"Transaction Success",value:I.TransactionSuccess}],E=S(!1),W=async()=>{try{u(),await y(m.value),E.value=!1,_(),v.success("Le webhook a bien été crée")}catch{}},D=L(async({})=>{await W()});return(g,a)=>(r(),H(ve,{"handle-submit":i(D),"backgroud-color":"bg-white",open:E.value,"onUpdate:open":a[5]||(a[5]=b=>E.value=b),showDivider:!1},{trigger:d(()=>[o(ne,{type:"outline"},{default:d(()=>[e("div",Us,[o(i(it),{class:"w-5 h-5 mr-2"}),a[6]||(a[6]=e("span",null,"CREATE SUBSCRITPION",-1))])]),_:1})]),title:d(()=>a[7]||(a[7]=[e("span",null,"WEB HOOKS",-1)])),content:d(()=>[e("div",Ws,[e("section",Bs,[a[8]||(a[8]=e("div",null,[e("p",{class:"flex-1 text-neutral-20"},"Nom")],-1)),e("div",Hs,[o(me,{name:"name",modelValue:m.value.name,"onUpdate:modelValue":a[0]||(a[0]=b=>m.value.name=b),type:"text",id:"name",placeholder:"WEBHOOK  NAME",class:"py-2 pr-12",required:""},null,8,["modelValue"])])]),e("section",Rs,[a[9]||(a[9]=e("div",null,[e("p",{class:"flex-1 text-neutral-20"},"URL")],-1)),e("div",Ds,[o(me,{name:"url",modelValue:m.value.url,"onUpdate:modelValue":a[1]||(a[1]=b=>m.value.url=b),type:"text",id:"name",placeholder:"https://example.com",class:"py-2 pr-12",required:""},null,8,["modelValue"])])]),e("section",Ns,[a[10]||(a[10]=e("div",null,[e("p",{class:"flex-1 text-neutral-20"},"Evenements")],-1)),e("div",Os,[o(zs,{animation:.5,"max-count":2,variant:"default",options:V,placeholder:"event",name:"events",modelValue:m.value.events,"onUpdate:modelValue":a[2]||(a[2]=b=>m.value.events=b),elements:V},null,8,["modelValue"])])]),e("section",Qs,[a[11]||(a[11]=e("div",null,[e("p",{class:"flex-1 text-neutral-20"},"Environnement")],-1)),e("div",Is,[o(Me,{name:"environment",modelValue:m.value.environment,"onUpdate:modelValue":a[3]||(a[3]=b=>m.value.environment=b),"border-color":"border-neutral-60","default-width":"w-full",title:"Environnement",elements:k.value},null,8,["modelValue","elements"])])])])]),footer:d(()=>[e("div",Ps,[o(i(X),{class:"flex-1 py-[22px] text-sm rounded-lg font-medium",variant:"outline",onClick:a[4]||(a[4]=b=>E.value=!1)},{default:d(()=>a[12]||(a[12]=[U(" Annuler ")])),_:1,__:[12]}),o(i(X),{type:"submit",class:"flex-1 py-[22px] text-sm rounded-lg bg-primary font-normal",variant:"default"},{default:d(()=>a[13]||(a[13]=[U(" Create ")])),_:1,__:[13]})])]),_:1},8,["handle-submit","open"]))}}),Xs={id:"true",class:"bg-white rounded-lg shadow-md p-6 my-4"},Js={class:"flex justify-between flex-col md:flex-row mb-5"},Ys={class:"w-full overflow-x-auto"},Zs={class:"min-w-[600px]"},en={class:"w-full mb-6"},tn={key:0},sn={class:"py-3"},nn={class:"py-3"},on={class:"py-3"},an={class:"py-3"},rn={class:"py-3"},ln={class:"flex justify-end gap-2"},un={key:1},dn={key:0},cn={class:"py-3 font-mono text-sm"},mn={class:"py-3"},pn={class:"bg-blue-100 text-blue-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded"},fn={class:"py-3 font-mono text-sm"},vn={class:"py-3 font-mono text-sm"},yn={class:"py-3 text-right"},hn={class:"flex justify-end gap-2"},xn=R({__name:"webHooks",setup(t){const s=ae(),n=J(),{startLoading:v,stopLoading:u,stopLoadingSkeleton:y}=ie(),{mutateAsync:L}=gs(s.params.id),{isFetched:_,data:k,isFetching:m}=hs(),{data:V,refetch:E,isLoading:W,isFetched:D,isFetching:g}=Te({enabled:!0}),a=F(()=>{var f,C;return((C=(f=V.value)==null?void 0:f.merchant)==null?void 0:C.status)===je.active}),b=F(()=>_.value?k.value.items.filter(f=>f.environment===j.Live).length===0:!1),$=F(()=>_.value?k.value.items.filter(f=>f.environment===j.Sandbox).length===0:!1),p=async f=>{try{v(),await L(f),n.success("Le webhook a bien été supprimé")}catch{}finally{u()}};return(f,C)=>(r(),c("div",Xs,[e("section",Js,[C[0]||(C[0]=e("div",null,[e("h2",{class:"text-xl font-semibold mb-2"},"Webhooks"),e("p",{class:"text-gray-600 mb-6"}," Create and manage your webhooks ")],-1)),pe(e("div",null,[o(Gs,{"can-add-live-key":b.value,"can-add-sandbox-key":$.value},null,8,["can-add-live-key","can-add-sandbox-key"])],512),[[Ve,a.value&&(b.value||$.value)]])]),e("section",Ys,[e("div",Zs,[e("table",en,[C[3]||(C[3]=e("thead",null,[e("tr",{class:"border-b"},[e("th",{class:"py-2 text-left text-gray-500 font-medium text-sm"},"Name"),e("th",{class:"py-2 text-left text-gray-500 font-medium text-sm"},"Environnement"),e("th",{class:"py-2 text-left text-gray-500 font-medium text-sm"},"URL"),e("th",{class:"py-2 text-left text-gray-500 font-medium text-sm"},"Secret key"),e("th",{class:"py-2 text-right text-gray-500 font-medium text-sm"},"Actions")])],-1)),o(qe,{name:"fade-slide",mode:"out-in"},{default:d(()=>[i(m)?(r(),c("tbody",tn,[(r(),c(Q,null,G(3,l=>e("tr",{key:l,class:"border-b"},[e("td",sn,[o(z,{class:"h-4 w-5/6"})]),e("td",nn,[o(z,{class:"h-4 w-5/6"})]),e("td",on,[o(z,{class:"h-4 w-full"})]),e("td",an,[o(z,{class:"h-4 w-3/4"})]),e("td",rn,[e("div",ln,[o(z,{class:"h-8 w-8 rounded"}),o(z,{class:"h-8 w-8 rounded"})])])])),64))])):(r(),c("tbody",un,[i(k).items.length===0?(r(),c("tr",dn,C[1]||(C[1]=[e("td",{colspan:"5",class:"py-4 text-center text-gray-500 text-sm",height:"100"},"No webhooks found",-1)]))):M("",!0),(r(!0),c(Q,null,G(i(k).items,l=>(r(),c("tr",{key:l.id,class:"border-b"},[e("td",cn,[e("span",null,q(l.name),1)]),e("td",mn,[e("span",pn,q(l.environment),1)]),e("td",fn,[e("span",null,q(l.url),1)]),e("td",vn,[e("span",null,q(l.secret),1)]),e("td",yn,[e("div",hn,[o(Bt,{successMessage:"La secret key a été copiée avec succes",dataToCopy:l.secret},null,8,["dataToCopy"]),a.value?(r(),H(Re,{key:0,confirmHandler:()=>p(l.id),"confirm-text":"Voulez vous vraiment supprimer ce webhook ?"},{default:d(()=>C[2]||(C[2]=[e("button",{class:"p-1.5 bg-red-100 hover:bg-red-200 rounded transition"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})])],-1)])),_:2,__:[2]},1032,["confirmHandler"])):M("",!0)])])]))),128))]))]),_:1})])])])]))}}),gn=fe(xn,[["__scopeId","data-v-b6ae72b8"]]),bn={class:"px-4 h-full"},_n={class:"flex justify-between items-center"},wn={class:"space-y-10"},Gn=R({__name:"securityView",setup(t){return(s,n)=>{const v=Xe("notification-icon");return r(),c("div",bn,[e("header",_n,[n[0]||(n[0]=e("div",{class:"mb-6 space-y-1"},[e("h1",{class:"text-xl font-bold font-merriweathersans leading-6 text-black"},"Webhooks & keys"),e("p",{class:"text-neutral-30 text-sm font-normal"},"Suivez, gérez vos tokens et vos web books ")],-1)),e("div",null,[o(v)])]),e("section",wn,[o(us),o(gn)])])}}});export{Gn as default};
